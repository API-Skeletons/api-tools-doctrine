<script>
$(function() {
    $('#toggleCheckboxes').on('click', function(event) {
        $('[name="entityClassName[]"]').prop("checked", $(this).is(':checked'));
    });

    $('#loadObjectManager').on('click', function(event) {
        window.location = '<?= $this->url('soliantconsulting-apigility-admin-select-entities', array('moduleName' => $this->moduleName)); ?>'
            + '/' + $('#objectManagerAlias').first().val();
        return false;
    });
});
</script>

<h1>Soliant Consulting</h1>
<h2>Apigility for Doctrine</h2>

<form method="post" action="<?= $this->url('soliantconsulting-apigility-admin-create-resources', array('moduleName' => $this->moduleName)); ?>">

<h3>Doctrine</h3>
Object Manager Alias
<input id="objectManagerAlias" type="text" size="50" name="objectManagerAlias"
    value="<?= $this->escapeHtml($this->objectManagerAlias); ?>">
<?php
if ($this->invalidObjectManager) {
?>
<p style="color: red">Invalid Object Manager Alias</p>

<?php
}
?>
<button id="loadObjectManager" class="btn btn-default">
Refresh Entity List
</button>

<?php
if (!$this->invalidObjectManager) {
?>
<h3>Doctrine Hydrator (ODM Only)</h3>
<input type="text" size="80" name="doctrineHydrator" value="DoctrineMongoODMModule\Hydrator\TenantEntityAssetHydrator">

<h3>Route Options</h3>

Route Prefix
<input type="text" name="routePrefix" value="api">

<br>
<br>


Use Entity Namespaces for Route
<input type="checkbox" name="useEntityNamespacesForRoute" value="1">
<br>
<br>
Should entity namespaces be used in route names?  e.g. entity name EtreeDb\Db\Entity\UserMeta would route to
<b>{route prefix} . /etree_db/db/entity/user_meta</b>

If you do not select this option the same route would be <b>{route prefix} . /user_meta</b>

<hr>

<h3>Select Entities</h3>

<table class="table table-striped table-hover">
<tr>
    <th>
        <input type="checkbox" id="toggleCheckboxes">
    </th>
</tr>


<?php
    foreach ($this->allMetadata as $metadata) {
?>
<tr>
    <td>
<input type="checkbox" name="entityClassName[]" value="<?= $this->escapeHtml($metadata->name); ?>">
<?= $this->escapeHtml($metadata->name); ?>
    </td>
</tr>
<?php
    }
?>
</table>

<input class="btn btn-success" type="submit" value="Create Api">

<?php
}
?>
</form>
